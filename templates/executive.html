{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>One Page Resume</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
  /* ===== HARD RESET ===== */
  @page {
    size: A4;
    margin: 0;
  }

  html, body {
    margin: 0 !important;
    padding: 0 !important;
    background: white;
    font-family: Arial, sans-serif;
  }

  /* ===== FORCE ONE PAGE ===== */
  .page {
    width: 210mm;
    height: 296mm;           /* ðŸ”¥ NOT 297mm */
    margin: 0 auto;
    background: white;
    padding: 12mm;
    box-sizing: border-box;
    border-top: 6px solid #1e3a8a;
    overflow: hidden;        /* ðŸ”’ CUT extra content */
  }

  .name {
    font-size: 26px;
    font-weight: 700;
    text-align: center;
    color: #1e3a8a;
  }

  .contact {
    text-align: center;
    font-size: 12px;
    color: #374151;
    margin-top: 4px;
  }

  .hr {
    border-top: 2px solid #c7d2fe;
    margin: 12px 0 16px;
  }

  .layout {
    display: flex;
    gap: 12mm;
  }

  .left { width: 65%; }
  .right { width: 35%; }

  .section {
    margin-bottom: 10px;
  }

  .title {
    font-size: 12px;
    font-weight: bold;
    color: #1e3a8a;
    border-bottom: 1px solid #c7d2fe;
    margin-bottom: 4px;
    padding-bottom: 2px;
  }

  .content {
    font-size: 11px;
    line-height: 1.35;
  }

  .content p { margin: 0 0 4px; }
  .content ul { margin: 0 0 4px 14px; }
</style>
</head>

<body>

<div class="page" id="resume-to-pdf">

  <div class="name">{{ resume.full_name }}</div>
  <div class="contact">
    {{ resume.phone }} â€¢ {{ resume.email }}
  </div>

  <div class="hr"></div>

  <div class="layout">

    <div class="left">
      {% if resume.summary %}
      <div class="section">
        <div class="title">SUMMARY</div>
        <div class="content">{{ resume.summary|safe }}</div>
      </div>
      {% endif %}

      {% if resume.experience %}
      <div class="section">
        <div class="title">EXPERIENCE</div>
        <div class="content">{{ resume.experience|safe }}</div>
      </div>
      {% endif %}
    </div>

    <div class="right">
      {% if resume.skills %}
      <div class="section">
        <div class="title">SKILLS</div>
        <div class="content">{{ resume.skills|safe }}</div>
      </div>
      {% endif %}

      {% if resume.education %}
      <div class="section">
        <div class="title">EDUCATION</div>
        <div class="content">{{ resume.education|safe }}</div>
      </div>
      {% endif %}
    </div>

  </div>
</div>

<!-- ===== PDF DOWNLOAD (NO DOUBLE PAGE) ===== -->
<script>
function downloadResumePDF() {

  const element = document.getElementById("resume-to-pdf");

  html2pdf()
    .set({
      filename: "{{ resume.full_name|default:'resume' }}.pdf",
      margin: 0,

      pagebreak: {
        before: [],
        after: [],
        avoid: ['*']
      },

      image: { type: "jpeg", quality: 1 },

      html2canvas: {
        scale: 1,              // ðŸ”¥ MUST be 1
        scrollX: 0,
        scrollY: 0,
        backgroundColor: "#ffffff"
      },

      jsPDF: {
        unit: "mm",
        format: "a4",
        orientation: "portrait"
      }
    })
    .from(element)
    .save();
}
</script>

</body>
</html>
