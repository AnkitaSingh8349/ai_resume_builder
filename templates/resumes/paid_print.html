<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Downloading PDF...</title>

  <!-- html2pdf library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    /* Screen styles (normal view) */
    body {
      margin: 0;
      padding: 0;
      background: #f3f4f6;
      font-family: Arial, sans-serif;
    }

    /* PDF container */
    .resume-print-area {
      background: white;
    }

    /* Force A4 sizing */
    @page {
      size: A4;
      margin: 0;
    }

    /* Hide scrollbars / flicker */
    html, body {
      width: 210mm;
      height: 297mm;
      overflow: hidden;
    }
  </style>
</head>

<body>

  <!-- âœ… THIS is what gets converted to PDF -->
  <div class="resume-print-area" id="resume-to-pdf">
    {% include template_file %}
  </div>

  <!-- PDF generation -->
  <script>
    window.onload = function () {
      const element = document.getElementById("resume-to-pdf");

      html2pdf()
        .set({
          filename: "{{ resume.full_name|default:'resume' }}.pdf",
          margin: 0,
          image: { type: "jpeg", quality: 0.98 },
          html2canvas: {
            scale: 2,
            useCORS: true,
            scrollY: 0
          },
          jsPDF: {
            unit: "mm",
            format: "a4",
            orientation: "portrait"
          }
        })
        .from(element)
        .save()
        .then(() => {
          // Optional redirect after download
          setTimeout(() => {
            window.location.href = "/";
          }, 2000);
        });
    };
  </script>

</body>
</html>
